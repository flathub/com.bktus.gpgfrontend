app-id: com.bktus.gpgfrontend
runtime: org.kde.Platform
runtime-version: '6.4'
sdk: org.kde.Sdk
command: GpgFrontend

finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --filesystem=host
  - --device=dri
  - --share=network

cleanup:
  - /lib/*.a
  - /lib/*.la
  - /lib32/*.a
  - /lib32/*.la
  - /share/doc
  - /share/gtk-doc
  - /share/man

modules:
  - name: gettext
    buildsystem: simple
    build-commands:
      - ./configure --prefix=${FLATPAK_DEST} && make -j$(nproc) && make install
    sources:
      - type: archive
        url: https://ftp.gnu.org/pub/gnu/gettext/gettext-0.19.8.tar.gz
        sha256: 3da4f6bd79685648ecf46dab51d66fcdddc156f41ed07e580a696a38ac61d48f
  - name: libgpg-error
    buildsystem: simple
    build-commands:
      - ./autogen.sh
      - ./configure --prefix=${FLATPAK_DEST} --enable-maintainer-mode && make -j$(nproc) && make install
    sources:
      - type: archive
        url: https://gnupg.org/ftp/gcrypt/libgpg-error/libgpg-error-1.42.tar.bz2
        sha256: fc07e70f6c615f8c4f590a8e37a9b8dd2e2ca1e9408f8e60459c67452b925e23
  - name: libassuan
    buildsystem: simple
    build-commands:
      - ./autogen.sh
      - ./configure --prefix=${FLATPAK_DEST} --enable-maintainer-mode && make -j$(nproc) && make install
    sources:
      - type: archive
        url: https://gnupg.org/ftp/gcrypt/libassuan/libassuan-2.5.5.tar.bz2
        sha256: 8e8c2fcc982f9ca67dcbb1d95e2dc746b1739a4668bc20b3a3c5be632edb34e4
  - name: gpgme
    buildsystem: simple
    build-commands:
      - ./autogen.sh
      - ./configure --prefix=${FLATPAK_DEST} --enable-maintainer-mode && make -j$(nproc) && make install
    sources:
      - type: archive
        url: https://gnupg.org/ftp/gcrypt/gpgme/gpgme-1.20.0.tar.bz2
        sha256: 25a5785a5da356689001440926b94e967d02e13c49eb7743e35ef0cf22e42750
  - name: pinentry
    buildsystem: simple
    build-commands:
      - ./autogen.sh
      - ./configure --prefix=${FLATPAK_DEST} --enable-maintainer-mode && make -j$(nproc) && make install
    sources:
      - type: archive
        url: https://gnupg.org/ftp/gcrypt/pinentry/pinentry-1.2.1.tar.bz2
        sha256: 457a185e5a85238fb945a955dc6352ab962dc8b48720b62fc9fa48c7540a4067
  - name: boost
    buildsystem: simple
    build-commands:
      - ./bootstrap.sh --prefix=${FLATPAK_DEST} --with-libraries=date_time,system
      - ./b2 variant=release link=static runtime-link=shared cxxflags="$CXXFLAGS" linkflags="$LDFLAGS" -j $(nproc) install
    sources:
      - type: archive
        url: https://boostorg.jfrog.io/artifactory/main/release/1.78.0/source/boost_1_78_0.tar.bz2
        sha256: 8681f175d4bdb26c52222665793eef08490d7758529330f98d3b29dd0735bccc
  - name: libconfig++
    buildsystem: simple
    build-commands:
      - ./configure --prefix=${FLATPAK_DEST} && make -j$(nproc) && make install
    sources:
      - type: archive
        url:  https://hyperrealm.github.io/libconfig/dist/libconfig-1.7.3.tar.gz
        sha256: 545166d6cac037744381d1e9cc5a5405094e7bfad16a411699bcff40bbb31ee7
  - name: gpgfrontend
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DGPGFRONTEND_GENERATE_LINUX_INSTALL_SOFTWARE=ON
    sources:
      - type: git
        url: https://github.com/saturneric/GpgFrontend.git
        commit: 0378dbdccc758ded7af1ca1bcf1144d8f656e82b

    